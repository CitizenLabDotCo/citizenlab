{
  "description": "Schema for validating the settings on a tenant",
  "type": "object",
  "required": ["core"],
  "additionalProperties": false,
  "properties":
    {
      "core": {
        "type": "object",
        "title": "Core system",
        "description": "The container for general settings. The core system should always be enabled.",
        "required-settings": ["organization_type", "timezone", "currency", "locales", "color_main", "color_secondary","color_text", "lifecycle_stage"],
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "organization_name": {
            "title": "Organisation Name",
            "description": "How the city or organisation is referred to throughout the platform.",
            "$ref": "#/definitions/multiloc_string"
          },
          "organization_site": {
            "title": "Organisation Website",
            "description": "The city or organisation's official website.",
            "type": "string",
            "pattern": "^$|^((http:\/\/.+)|(https:\/\/.+))"
          },
          "organization_type": {
            "title": "Organisation Type",
            "description": "Based on city's population: <40k small, 40-120k medium, >120k large. Otherwise, select 'generic'.",
            "type": "string",
            "enum": ["small_city", "medium_city", "large_city", "generic"],
            "default": "medium_city"
          },
          "lifecycle_stage": {
            "title": "Lifecycle Stage",
            "description": "The lifecycle stage of the customer.",
            "type": "string",
            "enum": ["trial", "expired_trial", "demo", "active", "churned", "not_applicable"],
            "default": "demo"
          },
          "timezone": {
            "title": "Time Zone",
            "type": "string",
            "default": "Brussels",
            "enum": [<%= ActiveSupport::TimeZone.all.sort_by{|tz| TimezoneService.new.display_timezone(tz)}.map(&:name).map{|l| "\"#{l}\""}.join(",") %>],
            "enumNames": [<%= ActiveSupport::TimeZone.all.map{|tz| TimezoneService.new.display_timezone(tz)}.sort.map{|l| "\"#{l}\""}.join(",") %>]
          },
          "currency": {
            "title": "Currency",
            "description": "Currency used by the organisation, for projects like participatory budgeting that have budget fields.",
            "type": "string",
            "default": "EUR",
            "enum": [<%= CL2_SUPPORTED_CURRENCIES.map{|l| "\"#{l}\""}.join(",") %>]
          },
          "locales": {
            "title": "Platform Languages",
            "description": "Select all of the languages that will be in use on the platform.",
            "type": "array",
            "items": {
              "type": "string",
              "enum": [<%= CL2_SUPPORTED_LOCALES.map{|l| "\"#{l}\""}.join(",") %>]
            },
            "uniqueItems": true,
            "minItems": 1,
            "default": ["en"]
          },
          "color_main": {
            "title": "Main Colour",
            "description": "Main colour of platform. Input as a 6-digit HEX color, including the # sign (e.g. #073F80).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#163A7D"
          },
          "color_secondary": {
            "title": "Secondary Colour",
            "description": "Secondary colour of platform. Input as a 6-digit HEX color, including the # sign (e.g. #ff672f).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#CF4040"
          },
          "color_text": {
            "title": "Text Colour",
            "description": "Colour of platform text. Input as a 6-digit HEX color, including the # sign (e.g. #7fbbca).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#163A7D"
          },
          "header_title": {
            "title": "Homepage Title",
            "description": "The header (title) shown on the main banner of the homepage (max 45 characters).",
            "type": "object",
            "allOf": [{"$ref": "#/definitions/multiloc_string"}],
            "additionalProperties": {"maxLength": 45}
          },
          "header_slogan": {
            "title": "Homepage Subtitle",
            "description": "The sub-title shown on the main banner of the homepage (max 90 characters).",
            "type": "object",
            "allOf": [{"$ref": "#/definitions/multiloc_string"}],
            "additionalProperties": {"maxLength": 90}
          },
          "meta_title": {
            "title": "Page Title",
            "description": "The title of the homepage displayed on the browser tab in search engine results and when shared on social media.",
            "$ref": "#/definitions/multiloc_string"
          },
          "meta_description": {
            "title": "Social Media Description",
            "description": "The description of the platform shown in search engine results and when shared on some social media platforms.",
            "$ref": "#/definitions/multiloc_string"
          },
          "custom_onboarding_message": {
            "title": "Header Banner Call-to-Action Text",
            "description": "Optional Call-to-Action text for signed in users, shown on a banner on the top of the homepage. Accompanied by a Call-to-Action (CTA) button. If this field is left blank, 'Header banner non-call to action' text is shown in the banner.",
            "$ref": "#/definitions/multiloc_string",
            "private": true
          },
          "custom_onboarding_button": {
            "title": "Header Banner CTA Button",
            "description": "Text for the CTA button in the header banner for signed-in users. Accompanies the 'Header banner call to action text' field.",
            "$ref": "#/definitions/multiloc_string",
            "private": true
          },
          "custom_onboarding_link": {
            "title": "Header Banner CTA Link",
            "description": "Web location that the CTA button links to. This should be a relative link on the platform starting with (e.g., platform.citizenlab.co/initiatives should be inputted here as /initiatives).",
            "type": "string",
            "pattern": "^$|^/.*$",
            "private": true
          },
          "custom_onboarding_fallback_message": {
            "title": "Header Banner Non-CTA Text",
            "description": "Optional text shown on a banner on the top of the homepage for signed in users. If this field and the 'Header Banner Call-to-Action Text' field are both left blank, the banner text defaults to \"{orgName} is listening to you. It's your turn to make your voice heard!\".",
            "$ref": "#/definitions/multiloc_string"
          },
          "currently_working_on_text": {
            "title": "Project Overview Header Title",
            "description": "Header title shown at the top of all of the projects on the homepage. If left blank, this field defaults to \"{orgName} is currently working on\".",
            "$ref": "#/definitions/multiloc_string"
          },
          "signup_helper_text": {
            "title": "Sign-up Helper Text (Step 1)",
            "description": "Optional short text, shown at the top of Step 1 of the sign up form (i.e., email and password). Supports HTML.",
            "$ref": "#/definitions/multiloc_string"
          },
          "custom_fields_signup_helper_text":  {
            "title": "Sign-up Helper Text (Step 2)",
            "description": "Optional short text, shown at the top of Step 2 of the sign up form (i.e., additional registration fields). Supports HTML.",
            "$ref": "#/definitions/multiloc_string"
          },
          "areas_term": {
            "title": "Geographic Units",
            "description": "What a geographic unit should be called on this platform (e.g., neighbourhoods, districts, etc.). Input the plural form here with all lowercase letters. If left blank, this field defaults to 'areas'.",
            "$ref": "#/definitions/multiloc_string"
          },
          "area_term": {
            "title": "Geographic Unit",
            "description": "What a geographic unit should be called on this platform (e.g., neighbourhood, district, etc.)? Input the singular form here with all lowercase letters. If left blank, this field defaults to 'area'.",
            "$ref": "#/definitions/multiloc_string"
          }
        }
      },

      "user_custom_fields": {
        "type": "object",
        "title": "Custom Registration Fields",
        "description":  "Allow admin to define custom registration fields.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "custom_idea_statuses": {
        "type": "object",
        "title": "Custom Idea Statuses",
        "description":  "Allows admin to define custom idea statuses.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "password_login": {
        "type": "object",
        "title": "Password Login",
        "description": "Allow users to register with an email and password.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["phone"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "phone": {
            "title": "Phone",
            "description": "Allow users to register with a phone number. This option is not advised, please check with development team before enabling this field.",
            "type": "boolean",
            "default": false
          },
          "phone_email_pattern": {
            "title": "Phone Number Format",
            "description": "Specify how phone numbers should be stored in the database (needs to be in email format - e.g., 'phone+__PHONE__@test.com' stores the phone number as 'phone+32478637483@test.com'.",
            "type": "string",
            "format": "email",
            "pattern": "^.*__PHONE__.*@.*$",
            "private": true
          }
        }
      },

      "facebook_login": {
        "type": "object",
        "title": "Facebook Login",
        "description":	"Allow users to register and sign in through their Facebook account.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["app_id"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "app_id": {
            "title": "App ID",
            "type": "string"
          },
          "app_secret": {
            "title": "App Secret",
            "type": "string",
            "private": true
          }
        }
      },

      "google_login": {
        "type": "object",
        "title": "Google Login",
        "description":  "Allow users to register and sign in through their Google account.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["client_id", "client_secret"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "client_id": {
            "title": "Client ID",
            "type": "string"
          },
          "client_secret": {
            "title": "Client Secret",
            "type": "string",
            "private": true
          }
        }
      },

      "azure_ad_login": {
        "type": "object",
        "title": "Azure Login",
        "description":  "Allow users to register and sign in with Azure Active Directory.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["tenant", "client_id", "logo_url", "login_mechanism_name"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "tenant": {
            "title": "Tenant",
            "type": "string",
            "private": true
          },
          "client_id": {
            "title": "Client ID",
            "description": "Sometimes also called 'application_id'",
            "type": "string",
            "private": true
          },
          "logo_url": {
            "title": "Logo",
            "type": "string",
            "pattern": "^https:\/\/.+",
            "description": "The full URL to the logo image that is shown on the authentication button. Logo should be approx. 25px in height."
          },
          "login_mechanism_name": {
            "title": "Login Mechanism Name",
            "type": "string",
            "description": "The Login Mechanism Name is used for user-facing copy. For instance, \"Sign up with {login_mechanism_name}.\"."
          }
        }
      },

      "franceconnect_login": {
        "type": "object",
        "title": "FranceConnect Login",
        "description":  "Allow users to register and sign in with a FranceConnect account.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["environment", "identifier", "secret"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "environment": {
            "type": "string",
            "title": "Environment",
            "description": "Live on the production FranceConnect environment or still testing on their integration environment?",
            "enum": ["production", "integration"],
            "default": "production",
            "private": true
          },
          "identifier": {
            "title": "Identifier",
            "type": "string",
            "private": true
          },
          "secret": {
            "title": "Secret Key",
            "type": "string",
            "private": true
          }
        }
      },

      "integration_onze_stad_app": {
        "type": "object",
        "description":  "Allow posting ideas to Onze StadApp as news.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["app_id", "api_key"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "app_id": {
            "title": "App ID",
            "type": "string",
            "private": true
          },
          "api_key": {
            "title": "API Key",
            "type": "string",
            "private": true
          }
        }
      },

      "verification": {
        "type": "object",
        "title": "Verification",
        "description": "Use a pre-defined list to verify user identities during registration.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["verification_methods"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "verification_methods": {
            "title": "Verification Methods",
            "private": true,
            "type": "array",
            "default": [],
            "items": {
              "anyOf":
                <%= Verification::VerificationService.new.all_methods.map do |method|
                    {
                      type: "object",
                      title: method.name,
                      required: ["name", *method.config_parameters],
                      properties: {
                        name: {type: "string", enum: [method.name], default: method.name, readOnly: true},
                        **method.config_parameters.map do |cp|
                          parameter_schema = method.respond_to?(:config_parameters_schema) && method.config_parameters_schema[cp]
                          [cp, parameter_schema || {type: "string", private: "true"}]
                        end.to_h
                      }
                    }
                  end.to_json
                %>
            }
          }
        }
      },

      "maps": {
        "type": "object",
        "title": "Maps",
        "description":  "Enable maps for all projects.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "tile_provider": {
            "title": "Tile provider",
            "description": "The OSM compatible tile provider URL pattern (https is required).",
            "type": "string",
            "pattern": "^https:\/\/.+",
            "default": "https://api.maptiler.com/maps/basic/{z}/{x}/{y}.png?key=DIZiuhfkZEQ5EgsaTk6D"
          },
          "map_center": {
            "title": "Map Center",
            "description": "The default center point of the platform maps (latitude/longitude). Use a dot as a decimal separator.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "lat": {
                "title": "Latitude",
                "type": "string",
                "default": "50.8503"
              },
              "long": {
                "title": "Longitude",
                "type": "string",
                "default": "4.3517"
              }
            }
          },
          "zoom_level": {
            "type": "number",
            "title": "Map Zoom Level",
            "description": "The zoom level of the platform maps. The Zoom Level should be a number between 0 - 19. The default zoom level is 12 (town). See https://wiki.openstreetmap.org/wiki/Zoom_levels for more information about zoom levels.",
            "default": 12
          },
          "osm_relation_id": {
            "type": "integer",
            "title": "OSM Relation ID",
            "description": "The boundary of the municipality/organisation is specified by its Relation ID in OpenStreetMap (OSM). You can find the Relation ID at https://www.openstreetmap.org. Search for the place, click on the correct result and you'll find the Relation ID if the result is a relation (e.g. \"Relation: Knokke-Heist (4569)\"). If there is no relation defined for the place (e.g. Scheveningen), search for the next largest administrative territory (e.g. The Hague)."
          }
        }
      },

      "geographic_dashboard": {
        "type": "object",
        "title": "Geographic Dashboard",
        "description":  "Shows a map with automatically detected idea locations. PoC, not yet stable.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "intercom": {
        "type": "object",
        "title": "Intercom Integration",
        "description":  "Integrates Intercom messenger and data collection",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },
      "segment": {
        "type": "object",
        "title": "Segment Integration",
        "description":  "Integrates segment data collection",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "destinations": {
            "type": "string",
            "description": "As more tools can be activated through Segment, here you can specify them using comma separated text, shown in the cookie consent"
          }
        }
      },

      "satismeter": {
        "type": "object",
        "title": "Satismeter Integration",
        "description":  "Integrates Satismeter polls and data collection to the front-end",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["write_key"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "write_key": {
            "type": "string",
            "description": "The write key the front-end send its data to.",
            "default": "<%= ENV.fetch('DEFAULT_SATISMETER_WRITE_KEY', '')%>"
          }
        }
      },

      "google_analytics": {
        "type": "object",
        "title": "Google Analytics Integration",
        "description":  "Integrates Google Analytics data collection to the front-end",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["tracking_id"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "tracking_id": {
            "type": "string",
            "description": "The tracking ID the front-end send it's data to. Format UA-XXXXXXXXX-XX",
            "pattern": "^(UA|YT|MO)\-[0-9]+\-[0-9]+$",
            "default": "<%= ENV.fetch('DEFAULT_GA_TRACKING_ID', '')%>"
          }
        }
      },
      "google_tag_manager": {
        "type": "object",
        "title": "Google Tag Manager Integration",
        "description": "Integrates Google Tag Manager with the front-end",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["container_id"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "destinations": {
            "type": "string",
            "description": "As more tools can be activated through GTM, here you can specify them using comma separated text, shown in the cookie consent"
          },
          "container_id": {
            "type": "string",
            "description": "The unique ID of your GTM workspace, format GTM-XXXXXXX",
            "pattern": "^GTM-[A-Z0-9]{1,7}$",
            "default": "<%= ENV.fetch('DEFAULT_GTM_CONTAINER_ID', '') %>"
          }
        }
      },

      "participatory_budgeting": {
        "type": "object",
        "title": "Participatory Budgeting",
        "description":  "Allow participatory budgeting.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "polls": {
        "type": "object",
        "title": "Polls",
        "description": "Allow polls.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "initiatives": {
        "type": "object",
        "title": "Proposals",
        "description":  "Allow proposals.",
        "additionalProperties": false,
        "required-settings": ["voting_threshold", "days_limit", "threshold_reached_message", "eligibility_criteria","success_stories"],
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true },
          "voting_threshold": {
            "title": "Voting Threshold",
            "description": "Default value for how many votes a proposal needs to move to the next stage. This value can be changed in the admin panel on the platform.",
            "type": "integer",
            "minimum": 2,
            "default": 300
          },
          "days_limit": {
            "title": "Time Limit (in days)",
            "description": "Default value for how many days a proposal has to meet the voting threshold and move to the next stage. This value can be changed in the admin panel on the platform.",
            "type": "integer",
            "minimum": 1,
            "default": 90
          },
          "threshold_reached_message": {
            "title": "Proposal Success Message",
            "description": "Default text that users receive when their proposal reaches the voting threshold. Supports HTML paragraphs and breaks. This text can be changed in the admin panel on the platform.",
            "$ref": "#/definitions/multiloc_string",
            "default": <%= MultilocService.new.i18n_to_multiloc(
            'initiatives.default_threshold_reached_message',
            locales: CL2_SUPPORTED_LOCALES).to_json
            %>
          },
          "eligibility_criteria": {
            "title": "Proposal Criteria",
            "description": "Default text specifying criteria that proposals should meet. Supports HTML paragraphs and breaks. This text can be changed in the admin panel on the platform.",
            "$ref": "#/definitions/multiloc_string",
            "default": <%= MultilocService.new.i18n_to_multiloc(
            'initiatives.default_eligibility_criteria',
            locales: CL2_SUPPORTED_LOCALES).to_json
            %>
          },
          "success_stories": {
            "type": "array",
            "title": "Proposal Success Stories",
            "description": "Link to other pages that highlight prior success stories and examples that users can refer to.",
            "default": [],
            "items": {
              "type": "object",
              "additionalProperties": false,
              "required": ["page_slug", "location", "image_url"],
              "properties": {
                "page_slug": {"type": "string"},
                "location": {"type": "string"},
                "image_url": {"type": "string", "format": "uri"}
              }
            }
          }
        }
      },

      "surveys": {
        "type": "object",
        "title": "Surveys",
        "description":  "Allow Typeform surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "typeform_surveys": {
        "type": "object",
        "title": "Typeform Surveys",
        "description":  "Allow Typeform surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "user_token": {
            "title": "User Token",
            "description": "The user token is generated from the tenant's typeform profile. Survey results are only downloadable for this token.",
            "type": "string",
            "private": true,
            "default": "<%= ENV.fetch('DEFAULT_TYPEFORM_USER_TOKEN', '') %>"
          }
        }
      },

      "google_forms_surveys": {
        "type": "object",
        "title": "Google Forms Surveys",
        "description":  "Allow Google Form surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "enalyzer_surveys": {
        "type": "object",
        "title": "Enalyzer Forms Surveys",
        "description":  "Allow Enalyzer surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "surveymonkey_surveys": {
        "type": "object",
        "title": "Surveymonkey Surveys",
        "description":  "Allow the embedding of Surveymonkey surveys. Deprecated, since not supported on mobile.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "volunteering": {
        "type": "object",
        "title": "Volunteering",
        "description": "Allow volunteering.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "workshops": {
        "title": "Workshops",
        "type": "object",
        "description":	"Allow workshops.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "machine_translations": {
        "type": "object",
        "title": "Machine Translations",
        "description":  "Allows users to see translated content.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "project_reports": {
        "type": "object",
        "title": "Project Reports",
        "description": "Browse and download the results of a project.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "clustering": {
        "type": "object",
        "title": "Clustering",
        "description":  "Allows admins to analyze ideas by creating clustered visualizations.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "similar_ideas": {
        "type": "object",
        "title": "Similar Ideas",
        "description":  "Show links to similar ideas when viewing an idea. Still in beta.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "admin_project_templates": {
        "type": "object",
        "title": "Project Templates",
        "description":  "Enable the template library for admin to create new projects.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "custom_topics": {
        "type": "object",
        "title": "Custom Topics",
        "description": "Admin and project managers can customize idea topics.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "idea_assignment": {
        "type": "object",
        "title": "Assign Ideas",
        "description": "Ideas can be assigned to specific admin and project managers to respond to.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "idea_custom_fields": {
        "type": "object",
        "title": "Custom Idea Fields",
        "description":  "Admin and project managers can specify which idea form fields to enable/disable or make mandatory.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "smart_groups": {
        "type": "object",
        "title": "Smart Groups",
        "description":  "Users can automatically be assigned to a group based on certain criteria.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "ideas_overview": {
        "type": "object",
        "title": "Idea Overview",
        "description":  "Create a page with all the ideas in a single overview page (mobile and desktop).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "disable_downvoting": {
        "type": "object",
        "title": "Disable Downvoting",
        "description": "Ideas and proposals cannot be downvoted, only upvoted.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "ideaflow_social_sharing": {
        "type": "object",
        "title": "Share Proposals on Social Media",
        "description":  "After posting a proposal, users receive a pop-up to share their proposal on social media.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "initiativeflow_social_sharing": {
        "type": "object",
        "title": "Share Initiative on Social Media",
        "description": "After posting an initiative, users receive a pop-up to share their proposal on social media.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "widgets": {
        "type": "object",
        "title": "Widgets",
        "description":  "Admins can generate platform widgets to embed on external websites.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "manual_emailing": {
        "type": "object",
        "title": "Manual Emails",
        "description":  "Admin and project managers can email users through the platform.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "automated_emailing_control": {
        "type": "object",
        "title": "Automated Emails",
        "description":  "Admin can set and control automated e-mail campaigns and notifications.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "pages": {
        "type": "object",
        "title": "Custom Pages",
        "description":	"Allow custom pages to be made and added to the platform's navigation.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "redirects": {
        "type": "object",
        "title": "URL redirection rules",
        "description":  "Define redirection rules on certain targets",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "rules": {
            "type": "array",
            "default": [],
            "items": {
              "type": "object",
              "required": ["path", "target"],
              "additionalProperties": false,
              "properties": {
                "path": {"type": "string", "description": "The URL path that should trigger the redirect. This is the part after the locale. For e.g. https://my-platform.com/en-GB/projects/my-project, the path would be projects/my-project."},
                "target": {"type": "string", "description": "The URL where the path should redirected to, e.g. https://google.com"}
              }
            }
          }
        }
      },

      "abbreviated_user_names": {
        "type": "object",
        "title": "Abbreviated User Name",
        "description": "NOTE: Once you have selected this option, you cannot change it back. User names are shown on the platform as first name + first initial (Jane D. instead of Jane Doe).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "moderation": {
        "type": "object",
        "title": "Moderation",
        "description": "Moderations are pieces of user-generated content that need to be moderated.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "manual_tagging": {
        "type": "object",
        "title": "Manual Tagging",
        "description": "Allows to manually analyze text inputs",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "automatic_tagging": {
        "type": "object",
        "title": "Automatic Tagging",
        "description": "Allows to automatically analyze text inputs",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "idea_custom_copy": {
        "type": "object",
        "title": "Idea Custom Copy",
        "description": "Allows the changing of the word `idea` as the default term of input.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "project_management": {
        "type": "object",
        "title": "Project Managers",
        "description": "Enable the project manager role (users who have some administrative rights at a project level).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "granular_permissions": {
        "type": "object",
        "title": "Granular Permissions",
        "description": "Admin can specify permissions for specific projects and project phases (e.g., who can post, vote, etc.).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "project_visibility": {
        "type": "object",
        "title": "Project Visibility",
        "description": "Admin can make projects visible only to certain groups of users (e.g., admin only, smart groups).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "private_projects": {
        "type": "object",
        "title": "Private projects",
        "description":  "Make projects visible to certain groups only (Access Rights tab in the Admin panel).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "fragments": {
        "type": "object",
        "title": "Fragments",
        "description":  "Internal system to allow specific pieces of UI to be overridden with custom HTML.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["enabled_fragments"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "enabled_fragments": {
            "title": "Enabled Fragments",
            "type": "array",
            "default": [],
            "description": "List of fragment names that should be enabled (e.g., 'signed-out-header').",
            "items": {
              "type": "string"
            }
          }
        }
      }
    },
  "dependencies": {
    "typeform_surveys": ["surveys"],
    "google_forms_surveys": ["surveys"],
    "enalyzer_surveys": ["surveys"],
    "surveymonkey_surveys": ["surveys"],
    "automatic_tagging": ["manual_tagging"]
  },
  "definitions": {
    "multiloc_string": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        <%= CL2_SUPPORTED_LOCALES.map{|l| "\"#{l.to_s}\": {\"type\": \"string\"}"}.join(",") %>
      }
    }
  }
}
