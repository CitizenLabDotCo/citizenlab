{
  "description": "Schema for validating the settings on a tenant",
  "$schema": "<%= TenantSchema::ExtendedSchema::SCHEMA_URL %>",
  "type": "object",
  "required": ["core"],
  "additionalProperties": false,
  "properties":
    {
      "core": {
        "type": "object",
        "title": "Core system",
        "description": "The container for general settings. The core system should always be enabled.",
        "required-settings": [
          "organization_type",
          "timezone",
          "currency",
          "locales",
          "color_main",
          "color_secondary",
          "color_text",
          "lifecycle_stage",
          "authentication_token_lifetime_in_days"
        ],
        "additionalProperties": false,
        "required": ["allowed", "enabled", "lifecycle_stage"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "organization_name": {
            "title": "Organisation Name",
            "description": "How the city or organisation is referred to throughout the platform.",
            "$ref": "#/definitions/multiloc_string"
          },
          "organization_site": {
            "title": "Organisation Website",
            "description": "The city or organisation's official website.",
            "type": "string",
            "pattern": "^$|^((http:\/\/.+)|(https:\/\/.+))"
          },
          "organization_type": {
            "title": "Organisation Type",
            "description": "Based on city's population: <40k small, 40-120k medium, >120k large. Otherwise, select 'generic'.",
            "type": "string",
            "enum": ["small_city", "medium_city", "large_city", "generic"],
            "default": "medium_city"
          },
          "lifecycle_stage": {
            "title": "Lifecycle Stage",
            "description": "The lifecycle stage of the customer.",
            "type": "string",
            "enum": ["trial", "expired_trial", "demo", "active", "churned", "not_applicable"]
          },
          "timezone": {
            "title": "Time Zone",
            "type": "string",
            "default": "Europe/Brussels",
            "enum": [<%= TimezoneService::SUPPORTED_TIMEZONES.map{|l| "\"#{l}\""}.join(",") %>],
            "enumNames": [<%= TimezoneService::SUPPORTED_TIMEZONES.map{|tz| TimezoneService.new.display_timezone(tz)}.map{|l| "\"#{l}\""}.join(",") %>]
          },
          "currency": {
            "title": "Currency",
            "description": "Currency used by the organisation, for projects like participatory budgeting that have budget fields.",
            "type": "string",
            "default": "EUR",
            "enum": [<%= CL2_SUPPORTED_CURRENCIES.map{|l| "\"#{l}\""}.join(",") %>]
          },
          "locales": {
            "title": "Platform Languages",
            "description": "Select all of the languages that will be in use on the platform.",
            "type": "array",
            "items": {
              "type": "string",
              "enum": [<%= CL2_SUPPORTED_LOCALES.map { |locale| "\"#{locale}\"" }.join(",") %>],
              "enumNames": [<%= CL2_SUPPORTED_LOCALES.map { |locale| locale.to_s == 'en' ? '"en-US"' : "\"#{locale}\"" }.join(",") %>]
            },
            "uniqueItems": true,
            "minItems": 1,
            "default": ["en"]
          },
          "weglot_api_key": {
            "title": "Weglot API key",
            "description": "Set the API key of Weglot to enable automatic page translations.",
            "type": "string"
          },
          "color_main": {
            "title": "Main Colour",
            "description": "Main colour of platform. Input as a 6-digit HEX color, including the # sign (e.g. #073F80).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#163A7D"
          },
          "color_secondary": {
            "title": "Secondary Colour",
            "description": "Secondary colour of platform. Input as a 6-digit HEX color, including the # sign (e.g. #ff672f).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#CF4040"
          },
          "color_text": {
            "title": "Text Colour",
            "description": "Colour of platform text. Input as a 6-digit HEX color, including the # sign (e.g. #7fbbca).",
            "type": "string",
            "pattern": "^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$",
            "default": "#163A7D"
          },
          "meta_title": {
            "title": "Page Title",
            "description": "The title of the homepage displayed on the browser tab in search engine results and when shared on social media.",
            "$ref": "#/definitions/multiloc_string"
          },
          "meta_description": {
            "title": "Social Media Description",
            "description": "The description of the platform shown in search engine results and when shared on some social media platforms.",
            "$ref": "#/definitions/multiloc_string"
          },
          "custom_onboarding_message": {
            "title": "Header Banner Call-to-Action Text",
            "description": "Optional Call-to-Action text for signed in users, shown on a banner on the top of the homepage. Accompanied by a Call-to-Action (CTA) button. If this field is left blank, 'Header banner non-call to action' text is shown in the banner.",
            "$ref": "#/definitions/multiloc_string",
            "private": true
          },
          "custom_onboarding_button": {
            "title": "Header Banner CTA Button",
            "description": "Text for the CTA button in the header banner for signed-in users. Accompanies the 'Header banner call to action text' field.",
            "$ref": "#/definitions/multiloc_string",
            "private": true
          },
          "custom_onboarding_link": {
            "title": "Header Banner CTA Link",
            "description": "Web location that the CTA button links to. This should be a relative link on the platform starting with (e.g., platform.citizenlab.co/initiatives should be inputted here as /initiatives).",
            "type": "string",
            "pattern": "^$|^/.*$",
            "private": true
          },
          "currently_working_on_text": {
            "title": "Project Overview Header Title",
            "description": "Header title shown at the top of all of the projects on the homepage. If left blank, this field defaults to \"{orgName} is currently working on\".",
            "$ref": "#/definitions/multiloc_string"
          },
          "signup_helper_text": {
            "title": "Sign-up Helper Text (Step 1)",
            "description": "Optional short text, shown at the top of Step 1 of the sign up form (i.e., email and password). Supports HTML.",
            "$ref": "#/definitions/multiloc_string"
          },
          "custom_fields_signup_helper_text":  {
            "title": "Sign-up Helper Text (Step 2)",
            "description": "Optional short text, shown at the top of Step 2 of the sign up form (i.e., additional registration fields). Supports HTML.",
            "$ref": "#/definitions/multiloc_string"
          },
          "onboarding":  {
            "title": "Onboarding (Step 3)",
            "description": "Onboarding step after login or signup, asking for topics you are interested in.",
            "type": "boolean",
            "default": false
          },
          "areas_term": {
            "title": "Geographic Units",
            "description": "What a geographic unit should be called on this platform (e.g., neighbourhoods, districts, etc.). Input the plural form here with all lowercase letters. If left blank, this field defaults to 'areas'.",
            "$ref": "#/definitions/multiloc_string"
          },
          "area_term": {
            "title": "Geographic Unit",
            "description": "What a geographic unit should be called on this platform (e.g., neighbourhood, district, etc.)? Input the singular form here with all lowercase letters. If left blank, this field defaults to 'area'.",
            "$ref": "#/definitions/multiloc_string"
          },
          "topics_term": {
            "title": "Tag Units",
            "description": "What a tag unit should be called on this platform (e.g., departments, themes, etc.). Input the plural form here with all lowercase letters. If left blank, this field defaults to 'tags'.",
            "$ref": "#/definitions/multiloc_string"
          },
          "topic_term": {
            "title": "Tag Unit",
            "description": "What a tag unit should be called on this platform (e.g., department, theme, etc.). Input the singular form here with all lowercase letters. If left blank, this field defaults to 'tag'.",
            "$ref": "#/definitions/multiloc_string"
          },
          "from_email": {
            "title": "From email",
            "description": "The email used in the from field when users receive emails. This should only be configured when the corresponding Second Line Support work has already happened and the customer has made the necessary DNS changes, or emails will not function at all.",
            "type": "string",
            "format": "email"
          },
          "reply_to_email": {
            "title": "Reply-to email",
            "description": "The email used in the reply-to field when users receive emails from automated campaigns.",
            "type": "string",
            "format": "email",
            "default": "support@citizenlab.co"
          },
          "authentication_token_lifetime_in_days": {
            "title": "Authentication token lifetime in days",
            "description": "How many days before an authentication token (a user session) is expired.",
            "type": "integer",
            "minimum": 1,
            "maximum": 30,
            "default": 30
          },
          "maximum_admins_number": {
            "title": "Maximum number of admin seats in the contract",
            "description": "Maximum allowed number of admin seats specified in the contract (leave blank for unlimited).",
            "type": ["integer", "null"]
          },
          "maximum_moderators_number": {
            "title": "Maximum number of managers in the contract",
            "description": "Maximum allowed number of project and folder managers specified in the contract (leave blank for unlimited).",
            "type": ["integer", "null"]
          },
          "additional_admins_number": {
            "title": "Additional number of admin seats",
            "description": "Number of admin seats bought additionally over the contract limit.",
            "type": ["integer", "null"]
          },
          "additional_moderators_number": {
            "title": "Additional number of manager seats",
            "description": "Number of project and folder manager seats bought additionally over the contract limit.",
            "type": ["integer", "null"]
          }
        }
      },

      "user_blocking": {
        "type": "object",
        "title": "User blocking",
        "description": "Admin can block or unblock users.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["duration"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false },
          "duration": {
            "title": "Duration of block (in days)",
            "description": "How many days a user will be blocked for. The user will remain blocked until this period expires, or an admin manually removes the block on the user. Changing this value changes the duration of subsequent blocks only.",
            "type": "integer",
            "minimum": 1,
            "default": 90
          }
        }
      },

      "internal_commenting": {
        "type": "object",
        "title": "Internal commenting",
        "description": "Admins and managers can comment internally on ideas and proposals.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "follow": {
        "type": "object",
        "title": "Follow",
        "description": "Allow users to passively follow and get notifications about some parts of the application",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "jsonforms_custom_fields": {
        "type": "object",
        "title": "Rework of user custom fields (experimental)",
        "description":  "Replaces react-json-forms with jsonforms for user custom fields form. Don't turn this on unless you know what you're doing.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "advanced_custom_pages": {
        "type": "object",
        "title": "Advanced Custom Pages",
        "description":	"Advanced Custom Pages features.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "project_folders": {
        "type": "object",
        "title": "Project Folders",
        "description": "Allow project folders.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "project_management": {
        "type": "object",
        "title": "Project Managers",
        "description": "Enable the project manager role (users who have some administrative rights at a project level).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "project_visibility": {
        "type": "object",
        "title": "Project Visibility",
        "description": "Admin can make projects visible only to certain groups of users (e.g., admin only, smart groups).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "password_login": {
        "type": "object",
        "title": "Password Login",
        "description": "Allow users to register with an email and password.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["minimum_length", "phone", "enable_signup"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "enable_signup": {
            "type": "boolean",
            "title": "Enable sign-up",
            "description": "If unchecked, only login via password is allowed for existing users; sign-up via password is disabled for new users.",
            "default": true
          },
          "minimum_length": {
            "type": "number",
            "title": "Minimum password length",
            "description": "The minimum number of characters required for a user password. The default value is 8 (min. 5, max. 72). Longer passwords are generally more secure. Changes to the min. password length will only apply to users that create a new account or update their existing password (existing accounts remain the same).",
            "minimum": 5,
            "maximum": 72,
            "default": 8
          },
          "phone": {
            "title": "Phone",
            "description": "Allow users to register with a phone number. This option is not advised, please check with development team before enabling this field.",
            "type": "boolean",
            "default": false
          },
          "phone_email_pattern": {
            "title": "Phone Number Format",
            "description": "Specify how phone numbers should be stored in the database (needs to be in email format - e.g., 'phone+__PHONE__@test.com' stores the phone number as 'phone+32478637483@test.com'.",
            "type": "string",
            "format": "email",
            "default": "phone+__PHONE__@test.com",
            "pattern": "^.*__PHONE__.*@.*$",
            "private": true
          }
        }
      },

      "facebook_login": {
        "type": "object",
        "title": "Facebook Login",
        "description":	"Allow users to register and sign in through their Facebook account.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "app_id": {
            "title": "App ID",
            "type": "string"
          },
          "app_secret": {
            "title": "App Secret",
            "type": "string",
            "private": true
          }
        }
      },

      "google_login": {
        "type": "object",
        "title": "Google Login",
        "description":  "Allow users to register and sign in through their Google account.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "client_id": {
            "title": "Client ID",
            "type": "string"
          },
          "client_secret": {
            "title": "Client Secret",
            "type": "string",
            "private": true
          }
        }
      },

      "azure_ad_login": {
        "type": "object",
        "title": "Azure Login",
        "description":  "Allow users to register and sign in with Azure Active Directory.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "tenant": {
            "title": "Tenant",
            "type": "string",
            "private": true
          },
          "client_id": {
            "title": "Client ID",
            "description": "Sometimes also called 'application_id'",
            "type": "string",
            "private": true
          },
          "logo_url": {
            "title": "Logo",
            "type": "string",
            "pattern": "^https:\/\/.+",
            "description": "The full URL to the logo image that is shown on the authentication button. Logo should be approx. 25px in height."
          },
          "login_mechanism_name": {
            "title": "Login Mechanism Name",
            "type": "string",
            "description": "The Login Mechanism Name is used for user-facing copy. For instance, \"Sign up with {login_mechanism_name}.\"."
          }
        }
      },

      "integration_onze_stad_app": {
        "type": "object",
        "description":  "Allow posting ideas to Onze StadApp as news.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["app_id", "api_key"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "app_id": {
            "title": "App ID",
            "type": "string",
            "private": true
          },
          "api_key": {
            "title": "API Key",
            "type": "string",
            "private": true
          }
        }
      },

      "maps": {
        "type": "object",
        "title": "CustomMaps",
        "description":  "Enable maps for all projects.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "tile_provider": {
            "title": "Tile provider",
            "description": "The OSM or basemap.at compatible tile provider URL pattern (https is required).",
            "type": "string",
            "pattern": "^https:\/\/.+",
            "default": "<%= ENV.fetch('DEFAULT_MAPS_TILE_PROVIDER', 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png')%>"
          },
          "map_center": {
            "title": "Map Center",
            "description": "The default center point of the platform maps (latitude/longitude). Use a dot as a decimal separator.",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "lat": {
                "title": "Latitude",
                "type": "string",
                "default": "50.8503"
              },
              "long": {
                "title": "Longitude",
                "type": "string",
                "default": "4.3517"
              }
            }
          },
          "zoom_level": {
            "type": "number",
            "title": "Map Zoom Level",
            "description": "The zoom level of the platform maps. The Zoom Level should be a number between 0 - 19. The default zoom level is 12 (town). See https://wiki.openstreetmap.org/wiki/Zoom_levels for more information about zoom levels.",
            "default": 12
          },
          "osm_relation_id": {
            "type": "integer",
            "title": "OSM Relation ID",
            "description": "The boundary of the municipality/organisation is specified by its Relation ID in OpenStreetMap (OSM). You can find the Relation ID at https://www.openstreetmap.org. Search for the place, click on the correct result and you'll find the Relation ID if the result is a relation (e.g. \"Relation: Knokke-Heist (4569)\"). If there is no relation defined for the place (e.g. Scheveningen), search for the next largest administrative territory (e.g. The Hague)."
          }
        }
      },

      "intercom": {
        "type": "object",
        "title": "Intercom Integration",
        "description":  "Integrates Intercom messenger and data collection",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "segment": {
        "type": "object",
        "title": "Segment Integration",
        "description":  "Integrates segment data collection",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "destinations": {
            "type": "string",
            "description": "As more tools can be activated through Segment, here you can specify them using comma separated text, shown in the cookie consent"
          }
        }
      },

      "planhat": {
        "type": "object",
        "title": "Planhat Integration",
        "description":  "Planhat integration for data collection (via Segment).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "satismeter": {
        "type": "object",
        "title": "Satismeter Integration",
        "description":  "Integrates Satismeter polls and data collection to the front-end",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["write_key"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "write_key": {
            "type": "string",
            "description": "The write key the front-end send its data to.",
            "default": "<%= ENV.fetch('DEFAULT_SATISMETER_WRITE_KEY', '')%>"
          }
        }
      },

      "google_analytics": {
        "type": "object",
        "title": "Google Analytics Integration",
        "description":  "Integrates Google Analytics data collection to the front-end",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["tracking_id"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "tracking_id": {
            "type": "string",
            "description": "The tracking ID the front-end send it's data to. Format UA-XXXXXXXXX-XX",
            "pattern": "^(UA|YT|MO)\-[0-9]+\-[0-9]+$",
            "default": "<%= ENV.fetch('DEFAULT_GA_TRACKING_ID', '')%>"
          }
        }
      },

      "polls": {
        "type": "object",
        "title": "Polls",
        "description": "Allow polls.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "initiatives": {
        "type": "object",
        "title": "Proposals",
        "description":  "Allow proposals. Disabling this feature removes the corresponding item from the navbar",
        "additionalProperties": false,
        "required-settings": ["reacting_threshold", "days_limit", "threshold_reached_message", "eligibility_criteria"],
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true },
          "require_review":{
            "title": "Require Review",
            "description": "Require Review. If enabled, proposals will need to be approved by an admin before they are visible to the public.",
            "type": "boolean",
            "default": false
          },
          "require_cosponsors":{
            "title": "Require Cosponsors",
            "description": "Require Cosponsors. If enabled, proposals will need to be cosponsored by other users.",
            "type": "boolean",
            "default": false
          },
          "cosponsors_number": {
            "title": "Number of cosponsors",
            "description": "The number of cosponsors required to publish a proposal.",
            "type": "integer",
            "minimum": 1,
            "default": 3
          },
          "voting_threshold": {
            "title": "Voting Threshold",
            "description": "Deprecated - Use 'Reacting Threshold'",
            "type": "integer",
            "minimum": 2,
            "default": 300
          },
          "reacting_threshold": {
            "title": "Reacting Threshold",
            "description": "Default value for how many votes (reactions) a proposal needs to move to the next stage. This value can be changed in the admin panel on the platform.",
            "type": "integer",
            "minimum": 2,
            "default": 300
          },
          "days_limit": {
            "title": "Time Limit (in days)",
            "description": "Default value for how many days a proposal has to meet the voting threshold and move to the next stage. This value can be changed in the admin panel on the platform.",
            "type": "integer",
            "minimum": 1,
            "default": 90
          },
          "threshold_reached_message": {
            "title": "Proposal Success Message",
            "description": "Default text that users receive when their proposal reaches the voting threshold. Supports HTML paragraphs and breaks. This text can be changed in the admin panel on the platform.",
            "$ref": "#/definitions/multiloc_string",
            "default": <%= MultilocService.new.i18n_to_multiloc(
            'initiatives.default_threshold_reached_message',
            locales: CL2_SUPPORTED_LOCALES).to_json
            %>
          },
          "eligibility_criteria": {
            "title": "Proposal Criteria",
            "description": "Default text specifying criteria that proposals should meet. Supports HTML paragraphs and breaks. This text can be changed in the admin panel on the platform.",
            "$ref": "#/definitions/multiloc_string",
            "default": <%= MultilocService.new.i18n_to_multiloc(
            'initiatives.default_eligibility_criteria',
            locales: CL2_SUPPORTED_LOCALES).to_json
            %>
          },
          "posting_tips": {
            "title": "Posting tips",
            "description": "Text specifying tips for posting a proposal.",
            "$ref": "#/definitions/multiloc_string",
            "default": <%= MultilocService.new.i18n_to_multiloc(
            'initiatives.default_posting_tips',
            locales: CL2_SUPPORTED_LOCALES).to_json
            %>
          },
          "allow_anonymous_participation": {
            "title": "Allow users to participate anonymously",
            "description": "Users may still choose to participate with their real name, but they will have the option to submit inputs or comments anonymously if they choose to do so. All users will still need to comply with the requirements set in the Access Rights tab for their comments and/or inputs to go through. Admins and/or project moderators will not be able to know the identity of users behind anonymous inputs or comments. They will, however, still be able to moderate these submissions as they do for non anonymous ones.",
            "type": "boolean",
            "default": false
          }
        }
      },

      "initiative_review": {
        "type": "object",
        "title": "Proposal Review",
        "description": "Allow proposal review. When this is enabled, the feature is activated. When disabled the require_review toggle in the BO & Proposal settings here will be ignored.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "initiative_cosponsors": {
        "type": "object",
        "title": "Proposal Cosponsors",
        "description": "This feature makes it possible to require cosponsors to publish a proposal.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "surveys": {
        "type": "object",
        "title": "Surveys",
        "description":  "Allow external surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "typeform_surveys": {
        "type": "object",
        "title": "Typeform Surveys",
        "description":  "Allow Typeform surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true},
          "user_token": {
            "title": "User Token",
            "description": "The user token is generated from the tenant's typeform profile. Survey results are only downloadable for this token.",
            "type": "string",
            "private": true,
            "default": "<%= ENV.fetch('DEFAULT_TYPEFORM_USER_TOKEN', '') %>"
          }
        }
      },

      "google_forms_surveys": {
        "type": "object",
        "title": "Google Forms Surveys",
        "description":  "Allow Google Form surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "enalyzer_surveys": {
        "type": "object",
        "title": "Enalyzer Forms Surveys",
        "description":  "Allow Enalyzer surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "survey_xact_surveys": {
        "type": "object",
        "title": "Survey Xact Forms Surveys",
        "description":  "Allow Survey Xact surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "surveymonkey_surveys": {
        "type": "object",
        "title": "Surveymonkey Surveys",
        "description":  "Allow the embedding of Surveymonkey surveys. Deprecated, since not supported on mobile.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "snap_survey_surveys": {
        "type": "object",
        "title": "Snap Survey Surveys",
        "description":  "Allow the embedding of Snap Survey surveys.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "qualtrics_surveys": {
        "type": "object",
        "title": "Qualtrics Surveys",
        "description":  "Allow Qualtrics surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "microsoft_forms_surveys": {
        "type": "object",
        "title": "Microsoft Forms Surveys",
        "description":  "Allow Microsoft Forms surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "smart_survey_surveys": {
        "type": "object",
        "title": "SmartSurvey Surveys",
        "description":  "Allow SmartSurvey surveys to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "konveio_document_annotation": {
        "type": "object",
        "title": "Konveio Document Annotation",
        "description":  "Allow Konveio document annotation to be embedded.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "volunteering": {
        "type": "object",
        "title": "Volunteering",
        "description": "Allow volunteering.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "workshops": {
        "title": "Workshops",
        "type": "object",
        "description":	"Allow workshops.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "project_reports": {
        "type": "object",
        "title": "Project Reports",
        "description": "Browse and download the results of a project.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "blocking_profanity": {
        "type": "object",
        "title": "Block Profanity",
        "description": "Prevent input with profanity in it from being posted (can be turned on/off from the platform)",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "clustering": {
        "type": "object",
        "title": "Clustering",
        "description":  "Allows admins to analyze ideas by creating clustered visualizations.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "similar_ideas": {
        "type": "object",
        "title": "Similar Ideas",
        "description":  "Show links to similar ideas when viewing an idea. Still in beta.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "admin_project_templates": {
        "type": "object",
        "title": "Project Templates",
        "description":  "Enable the template library for admin to create new projects.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "custom_accessibility_statement_link": {
        "type": "object",
        "title": "Custom A11y Statement Link",
        "description":  "Allows the Front-End to direct the user to a different accessibility statement link than our own.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["url"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "url": {
            "title": "URL",
            "description": "The link to the page to which users should be redirected when clicking on the accessibility statement link within the footer.",
            "type": "string",
            "format": "uri"
          }
        }
      },

      "disable_downvoting": {
        "type": "object",
        "title": "Downvoting Toggle",
        "description": "Display toggle in Project settings or Project’s timeline phase settings, that permits the disabling and re-enabling of downvoting. By default, downvoting is enabled.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "disable_disliking": {
        "type": "object",
        "title": "Disliking Toggle",
        "description": "Display toggle in Project settings or Project’s timeline phase settings, that permits the disabling and re-enabling of dislike reactions. By default, disliking is enabled. (previously called disable_downvoting",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "ideaflow_social_sharing": {
        "type": "object",
        "title": "Share Ideas on Social Media",
        "description":  "After posting an idea, users receive a pop-up to share their idea on social media.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "initiativeflow_social_sharing": {
        "type": "object",
        "title": "Share Proposals on Social Media",
        "description": "After posting a proposal, users receive a pop-up to share their proposal on social media.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "widgets": {
        "type": "object",
        "title": "Widgets",
        "description":  "Admins can generate platform widgets to embed on external websites.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "manual_emailing": {
        "type": "object",
        "title": "Manual Emails",
        "description":  "Admin and project managers can email users through the platform.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "automated_emailing_control": {
        "type": "object",
        "title": "Automated Emails",
        "description":  "Admin can set and control automated e-mail campaigns and notifications.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "pages": {
        "type": "object",
        "title": "Custom Pages",
        "description":	"Allow custom pages to be made and added to the platform's navigation.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "events_widget": {
        "type": "object",
        "title": "Events Landing Page Widget",
        "description":	"Display a widget of the next upcoming events in your landing page.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": true},
          "widget_title": {"$ref": "#/definitions/multiloc_string"}
        }
      },

      "redirects": {
        "type": "object",
        "title": "URL redirection rules",
        "description":  "Define redirection rules on certain targets",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false },
          "rules": {
            "type": "array",
            "default": [],
            "items": {
              "type": "object",
              "required": ["path", "target"],
              "additionalProperties": false,
              "properties": {
                "path": {"type": "string", "description": "The URL path that should trigger the redirect. This is the part after the locale. For e.g. https://my-platform.com/en-GB/projects/my-project, the path would be projects/my-project."},
                "target": {"type": "string", "description": "The URL where the path should redirected to, e.g. https://google.com"}
              }
            }
          }
        }
      },

      "abbreviated_user_names": {
        "type": "object",
        "title": "Abbreviated User Name",
        "description": "NOTE: Once you have selected this option, you cannot change it back. User names are shown on the platform as first name + first initial (Jane D. instead of Jane Doe).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "idea_custom_copy": {
        "type": "object",
        "title": "Idea Custom Copy",
        "description": "Allows the changing of the word `idea` as the default term of input.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "idea_author_change": {
        "type": "object",
        "title": "Idea Author Change",
        "description": "Allows city admins to create ideas and assign users as their authors.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "private_projects": {
        "type": "object",
        "title": "Private projects",
        "description":  "Make projects visible to certain groups only (Access Rights tab in the Admin panel).",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true},
          "enabled": { "type": "boolean", "default": true}
        }
      },

      "disable_user_bios": {
        "type": "object",
        "title": "Disable User Biographies",
        "description":  "When this is enabled, the user biographies get disabled on the platform.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false}
        }
      },

      "fragments": {
        "type": "object",
        "title": "Fragments",
        "description":  "Internal system to allow specific pieces of UI to be overridden with custom HTML.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "required-settings": ["enabled_fragments"],
        "properties": {
          "allowed": { "type": "boolean", "default": false},
          "enabled": { "type": "boolean", "default": false},
          "enabled_fragments": {
            "title": "Enabled Fragments",
            "type": "array",
            "default": [],
            "description": "List of fragment names that should be enabled (e.g., 'signed-out-header').",
            "items": {
              "type": "string"
            }
          }
        }
      },

      "representativeness": {
        "type": "object",
        "title": "Representativeness",
        "description": "Enables the representativeness dashboard.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "native_surveys": {
        "type": "object",
        "title": "Allow in-platform surveys",
        "description":  "",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "seat_based_billing": {
        "type": "object",
        "title": "Seat based billing",
        "description":  "Enables seat-based billing.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "visitors_dashboard": {
        "type": "object",
        "title": "Visitors dashboard",
        "description": "Enabled the visitors dashboard. Don't turn this on unless you know what you're doing.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "input_form_custom_fields": {
        "type": "object",
        "title": "Input form builder custom fields",
        "description": "Enables the ability to create custom fields within the ideation form builder.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "user_confirmation": {
        "type": "object",
        "title": "User email confirmation",
        "description": "Enables the ability for emails to be confirmed after registration.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": true }
        }
      },

      "permission_option_email_confirmation": {
        "type": "object",
        "title": "Registration via email confirmation",
        "description": "Enables a light registration flow where users enter just an email address and a confirmation code.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "permissions_custom_fields": {
        "type": "object",
        "title": "Permission custom fields on project actions",
        "description": "Enables the option for admins to add custom questions to project action permissions.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "anonymous_participation": {
        "type": "object",
        "title": "Anonymous participation",
        "description": "Turning on this feature is recommended if boosting engagement is important and/or the client is running a complex project where they anticipate some residents being afraid of speaking up. Users may still choose to participate with their real name, but if enabled they will have the option to submit inputs, comments or proposals anonymously if they choose to do so. All users will still need to comply with the requirements for participation set by admins or project moderators for that project.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": false },
          "enabled": { "type": "boolean", "default": false }
        }
      },

      "public_api_tokens": {
        "type": "object",
        "title": "Public API tokens",
        "description": "Enables the ability to create API tokens for the public API.",
        "additionalProperties": false,
        "required": ["allowed", "enabled"],
        "properties": {
          "allowed": { "type": "boolean", "default": true },
          "enabled": { "type": "boolean", "default": false }
        }
      }
    },
  "dependencies": {
    "planhat": ["segment"],

    "typeform_surveys": ["surveys"],
    "google_forms_surveys": ["surveys"],
    "enalyzer_surveys": ["surveys"],
    "survey_xact_surveys": ["surveys"],
    "surveymonkey_surveys": ["surveys"],
    "qualtrics_surveys": ["surveys"],
    "snap_survey_surveys": ["surveys"],
    "microsoft_forms_surveys": ["surveys"],
    "smart_survey_surveys": ["surveys"],

    "id_auth0": ["verification"],
    "id_bogus": ["verification"],
    "id_bosa_fas": ["verification"],
    "id_clave_unica": ["verification"],
    "id_cow": ["verification"],
    "id_franceconnect": ["verification"],
    "id_gent_rrn": ["verification"],
    "id_oostende_rrn": ["verification"],
    "id_id_card_lookup": ["verification"],

    "permission_option_email_confirmation": ["user_confirmation"]
  },
  "definitions": {
    "multiloc_string": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        <%= CL2_SUPPORTED_LOCALES.map{|l| "\"#{l.to_s}\": {\"type\": \"string\"}"}.join(",") %>
      }
    }
  }
}
